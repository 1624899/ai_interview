# ğŸš€ å¿«é€Ÿå¯åŠ¨æŒ‡å— - å†å²ä¼šè¯åŠŸèƒ½

## ç¬¬ä¸€æ­¥ï¼šå¯åŠ¨åç«¯æœåŠ¡

```bash
# è¿›å…¥åç«¯ç›®å½•
cd backend

# æ¿€æ´»è™šæ‹Ÿç¯å¢ƒï¼ˆå¦‚æœæœ‰ï¼‰
conda activate langchain  # æˆ–è€…ä½ çš„ç¯å¢ƒå

# å¯åŠ¨æœåŠ¡
python main.py
```

âœ… çœ‹åˆ°ä»¥ä¸‹è¾“å‡ºè¡¨ç¤ºå¯åŠ¨æˆåŠŸï¼š
```
AI é¢è¯•åŠ©æ‰‹åç«¯æœåŠ¡å¯åŠ¨ä¸­...
æ•°æ®ç›®å½•åˆå§‹åŒ–å®Œæˆ
å¯åŠ¨æœåŠ¡å™¨: http://0.0.0.0:8000
API æ–‡æ¡£: http://0.0.0.0:8000/docs
```

## ç¬¬äºŒæ­¥ï¼šéªŒè¯APIå¯ç”¨æ€§

### æ–¹æ³•1ï¼šè®¿é—®APIæ–‡æ¡£
åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š`http://localhost:8000/docs`

ä½ ä¼šçœ‹åˆ°æ‰€æœ‰APIæ¥å£ï¼ŒåŒ…æ‹¬æ–°å¢çš„ä¼šè¯ç®¡ç†æ¥å£ï¼š
- `POST /api/sessions/` - åˆ›å»ºä¼šè¯
- `GET /api/sessions/` - è·å–ä¼šè¯åˆ—è¡¨
- `GET /api/sessions/{session_id}` - è·å–ä¼šè¯è¯¦æƒ…
- `PATCH /api/sessions/{session_id}` - æ›´æ–°ä¼šè¯
- `DELETE /api/sessions/{session_id}` - åˆ é™¤ä¼šè¯
- `POST /api/sessions/{session_id}/messages` - æ·»åŠ æ¶ˆæ¯

### æ–¹æ³•2ï¼šè¿è¡Œæµ‹è¯•è„šæœ¬

```bash
# åœ¨æ–°çš„ç»ˆç«¯çª—å£
cd backend
python test_sessions.py
```

âœ… æµ‹è¯•é€šè¿‡ä¼šæ˜¾ç¤ºï¼š
```
=== æµ‹è¯•åˆ›å»ºä¼šè¯ ===
çŠ¶æ€ç : 200
åˆ›å»ºæˆåŠŸ: {...}

=== æµ‹è¯•è·å–ä¼šè¯åˆ—è¡¨ ===
çŠ¶æ€ç : 200
ä¼šè¯æ€»æ•°: 1
...

æµ‹è¯•å®Œæˆï¼
```

## ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨å‰ç«¯ï¼ˆå¯é€‰ï¼‰

```bash
# åœ¨æ–°çš„ç»ˆç«¯çª—å£
cd web
npm run dev
```

å‰ç«¯å°†åœ¨ `http://localhost:3000` å¯åŠ¨

## ç¬¬å››æ­¥ï¼šæµ‹è¯•å®Œæ•´æµç¨‹

### ä½¿ç”¨Postmanæˆ–curlæµ‹è¯•

#### 1. åˆ›å»ºä¼šè¯
```bash
curl -X POST "http://localhost:8000/api/sessions/" \
  -H "Content-Type: application/json" \
  -d '{
    "mode": "coach",
    "title": "æˆ‘çš„ç¬¬ä¸€ä¸ªé¢è¯•ä¼šè¯",
    "max_questions": 5
  }'
```

**é¢„æœŸå“åº”**ï¼š
```json
{
  "success": true,
  "session": {
    "session_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
    "title": "æˆ‘çš„ç¬¬ä¸€ä¸ªé¢è¯•ä¼šè¯",
    "created_at": "2025-11-28T12:40:00",
    "metadata": {
      "mode": "coach",
      "question_count": 0,
      "max_questions": 5,
      "status": "active"
    },
    "messages": []
  }
}
```

**ğŸ“ è®°ä¸‹è¿”å›çš„ `session_id`ï¼Œåç»­æ­¥éª¤ä¼šç”¨åˆ°ï¼**

#### 2. è·å–ä¼šè¯åˆ—è¡¨
```bash
curl "http://localhost:8000/api/sessions/"
```

**é¢„æœŸå“åº”**ï¼š
```json
{
  "success": true,
  "sessions": [
    {
      "session_id": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
      "title": "æˆ‘çš„ç¬¬ä¸€ä¸ªé¢è¯•ä¼šè¯",
      "mode": "coach",
      "status": "active",
      "message_count": 0,
      ...
    }
  ],
  "total": 1
}
```

#### 3. æ·»åŠ æ¶ˆæ¯åˆ°ä¼šè¯
```bash
# æ›¿æ¢ {session_id} ä¸ºå®é™…çš„ä¼šè¯ID
curl -X POST "http://localhost:8000/api/sessions/{session_id}/messages?role=user&content=ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±"
```

#### 4. æŸ¥çœ‹ä¼šè¯è¯¦æƒ…ï¼ˆåŒ…å«æ¶ˆæ¯ï¼‰
```bash
curl "http://localhost:8000/api/sessions/{session_id}"
```

**é¢„æœŸå“åº”**ï¼š
```json
{
  "success": true,
  "session": {
    "session_id": "...",
    "title": "æˆ‘çš„ç¬¬ä¸€ä¸ªé¢è¯•ä¼šè¯",
    "messages": [
      {
        "role": "user",
        "content": "ä½ å¥½ï¼Œè¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±",
        "timestamp": "2025-11-28T12:45:00"
      }
    ],
    ...
  }
}
```

#### 5. æ›´æ–°ä¼šè¯çŠ¶æ€
```bash
curl -X PATCH "http://localhost:8000/api/sessions/{session_id}" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "å·²å®Œæˆçš„é¢è¯•",
    "status": "completed"
  }'
```

## ç¬¬äº”æ­¥ï¼šæµ‹è¯•ä¸èŠå¤©APIçš„é›†æˆ

### 1. ä¸Šä¼ ç®€å†ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
```bash
curl -X POST "http://localhost:8000/api/upload/resume" \
  -F "file=@/path/to/your/resume.pdf"
```

### 2. ä½¿ç”¨ä¼šè¯IDè¿›è¡ŒèŠå¤©
```bash
# ä½¿ç”¨ä¹‹å‰åˆ›å»ºçš„ session_id ä½œä¸º thread_id
curl -X POST "http://localhost:8000/api/chat/stream" \
  -H "Content-Type: application/json" \
  -d '{
    "thread_id": "{session_id}",
    "message": "è¯·ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±",
    "mode": "coach",
    "resume_context": "...",
    "job_description": "Pythonå¼€å‘å·¥ç¨‹å¸ˆ",
    "max_questions": 5
  }'
```

### 3. å†æ¬¡æŸ¥çœ‹ä¼šè¯è¯¦æƒ…
```bash
curl "http://localhost:8000/api/sessions/{session_id}"
```

âœ… ä½ ä¼šçœ‹åˆ°ï¼š
- ç”¨æˆ·æ¶ˆæ¯å·²è‡ªåŠ¨ä¿å­˜
- AIçš„å®Œæ•´å“åº”å·²è‡ªåŠ¨ä¿å­˜
- `message_count` å·²æ›´æ–°

## ğŸ“‚ æŸ¥çœ‹æ•°æ®åº“

### ä½¿ç”¨SQLiteå‘½ä»¤è¡Œå·¥å…·
```bash
# æ‰“å¼€æ•°æ®åº“
sqlite3 backend/data/sessions.db

# æŸ¥çœ‹æ‰€æœ‰è¡¨
.tables

# æŸ¥çœ‹sessionsè¡¨ç»“æ„
.schema sessions

# æŸ¥çœ‹æ‰€æœ‰ä¼šè¯
SELECT session_id, title, mode, status, created_at FROM sessions;

# æŸ¥çœ‹æŸä¸ªä¼šè¯çš„æ¶ˆæ¯
SELECT role, content, timestamp FROM messages WHERE session_id = 'xxx';

# é€€å‡º
.quit
```

### ä½¿ç”¨PythonæŸ¥çœ‹
```python
import sqlite3

conn = sqlite3.connect('backend/data/sessions.db')
cursor = conn.cursor()

# æŸ¥çœ‹æ‰€æœ‰ä¼šè¯
cursor.execute('SELECT * FROM sessions')
for row in cursor.fetchall():
    print(row)

conn.close()
```

### ä½¿ç”¨å›¾å½¢åŒ–å·¥å…·
æ¨èä½¿ç”¨ä»¥ä¸‹å·¥å…·æŸ¥çœ‹SQLiteæ•°æ®åº“ï¼š
- **DB Browser for SQLite** (å…è´¹ï¼Œè·¨å¹³å°)
- **SQLiteStudio** (å…è´¹ï¼Œè·¨å¹³å°)
- **VS Code SQLiteæ‰©å±•**

## ğŸ¯ å¸¸è§é—®é¢˜

### Q1: å¯åŠ¨åç«¯æ—¶æŠ¥é”™ "ModuleNotFoundError"
**A**: ç¡®ä¿å·²å®‰è£…æ‰€æœ‰ä¾èµ–ï¼š
```bash
pip install -r requirements.txt
```

### Q2: æµ‹è¯•è„šæœ¬è¿æ¥å¤±è´¥
**A**: ç¡®ä¿åç«¯æœåŠ¡å·²å¯åŠ¨å¹¶ç›‘å¬åœ¨ 8000 ç«¯å£

### Q3: ä¼šè¯æ•°æ®ä¿å­˜åœ¨å“ªé‡Œï¼Ÿ
**A**: SQLiteæ•°æ®åº“æ–‡ä»¶ï¼š`backend/data/sessions.db`

### Q4: å¦‚ä½•æ¸…ç©ºæ‰€æœ‰ä¼šè¯æ•°æ®ï¼Ÿ
**A**: 
```bash
# æ–¹æ³•1ï¼šåˆ é™¤æ•°æ®åº“æ–‡ä»¶
rm backend/data/sessions.db
# ä¸‹æ¬¡å¯åŠ¨ä¼šè‡ªåŠ¨åˆ›å»ºæ–°æ•°æ®åº“

# æ–¹æ³•2ï¼šä½¿ç”¨SQLåˆ é™¤
sqlite3 backend/data/sessions.db "DELETE FROM sessions;"
```

### Q5: å¦‚ä½•å¤‡ä»½ä¼šè¯æ•°æ®ï¼Ÿ
**A**:
```bash
# ç®€å•å¤åˆ¶
cp backend/data/sessions.db backend/data/sessions_backup.db

# æˆ–ä½¿ç”¨SQLiteå¤‡ä»½å‘½ä»¤
sqlite3 backend/data/sessions.db ".backup backend/data/sessions_backup.db"
```

### Q6: æ¶ˆæ¯æ²¡æœ‰è‡ªåŠ¨ä¿å­˜ï¼Ÿ
**A**: æ£€æŸ¥ï¼š
1. æ˜¯å¦ä½¿ç”¨äº†æ­£ç¡®çš„ `thread_id`ï¼ˆåº”è¯¥æ˜¯å·²åˆ›å»ºçš„ `session_id`ï¼‰
2. åç«¯æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯ä¿¡æ¯
3. æ•°æ®åº“æ–‡ä»¶æ˜¯å¦å­˜åœ¨ä¸”å¯å†™

### Q7: å¦‚ä½•æŸ¥çœ‹æ•°æ®åº“å†…å®¹ï¼Ÿ
**A**: ä½¿ç”¨SQLiteå‘½ä»¤è¡Œå·¥å…·æˆ–å›¾å½¢åŒ–å·¥å…·ï¼ˆå¦‚DB Browser for SQLiteï¼‰

## ğŸ“Š æˆåŠŸæ ‡å¿—

å®Œæˆä»¥ä¸Šæ­¥éª¤åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

- âœ… åˆ›å»ºæ–°çš„é¢è¯•ä¼šè¯
- âœ… æŸ¥çœ‹æ‰€æœ‰å†å²ä¼šè¯åˆ—è¡¨
- âœ… æŸ¥çœ‹å•ä¸ªä¼šè¯çš„å®Œæ•´å¯¹è¯å†å²
- âœ… æ›´æ–°ä¼šè¯ä¿¡æ¯ï¼ˆæ ‡é¢˜ã€çŠ¶æ€ç­‰ï¼‰
- âœ… åœ¨èŠå¤©æ—¶è‡ªåŠ¨ä¿å­˜æ¶ˆæ¯
- âœ… åˆ é™¤ä¸éœ€è¦çš„ä¼šè¯

## ğŸ‰ ä¸‹ä¸€æ­¥

åç«¯åŠŸèƒ½å·²å®Œå…¨å°±ç»ªï¼ç°åœ¨å¯ä»¥ï¼š

1. **é›†æˆåˆ°å‰ç«¯**: å‚è€ƒ `docs/SESSION_MANAGEMENT.md` ä¸­çš„å‰ç«¯é›†æˆå»ºè®®
2. **è‡ªå®šä¹‰åŠŸèƒ½**: æ ¹æ®éœ€æ±‚æ‰©å±•ä¼šè¯ç®¡ç†åŠŸèƒ½
3. **éƒ¨ç½²ä¸Šçº¿**: å°†æœåŠ¡éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- è¯¦ç»†APIæ–‡æ¡£: `docs/SESSION_MANAGEMENT.md`
- å®ç°æ€»ç»“: `docs/ä¼šè¯åŠŸèƒ½å®ç°æ€»ç»“.md`
- APIäº¤äº’å¼æ–‡æ¡£: `http://localhost:8000/docs`

---

**éœ€è¦å¸®åŠ©ï¼Ÿ** æŸ¥çœ‹æ—¥å¿—æ–‡ä»¶æˆ–åœ¨ç»ˆç«¯æŸ¥çœ‹é”™è¯¯ä¿¡æ¯ã€‚
