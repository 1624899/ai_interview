# 🎯 AI 面试智能体 - 项目开发路线

## 项目概述

这是一个基于 **LangGraph** 的 AI 面试模拟系统，帮助求职者进行个性化面试练习。系统支持简历解析、针对性提问、实时对话和能力评估报告生成。

---

## 系统架构

### 总体架构

```
┌─────────────────────────────────────────────────────────────────┐
│                        前端 (Next.js)                           │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │  会话管理   │  │  聊天界面   │  │     能力档案视图        │  │
│  │ SessionList │  │ ChatMessage │  │ AbilityProfileView      │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                              │ HTTP/SSE
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                     后端 API (FastAPI)                          │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │   /chat/    │  │ /sessions/  │  │      /upload/           │  │
│  │ stream      │  │   CRUD      │  │       resume            │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                    核心逻辑层 (LangGraph)                        │
│  ┌──────────────────────────────────────────────────────────┐   │
│  │                   面试状态机 (graph.py)                   │   │
│  │  ┌─────────┐   ┌──────────┐   ┌─────────────┐            │   │
│  │  │ 开场白  │ → │  提问    │ → │ 分析/追问   │            │   │
│  │  └─────────┘   └──────────┘   └─────────────┘            │   │
│  │       ↑                              │                    │   │
│  │       └──────────────────────────────┘                    │   │
│  └──────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────┘
                              │
                              ▼
┌─────────────────────────────────────────────────────────────────┐
│                      数据层 (PostgreSQL)                         │
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────────┐  │
│  │  sessions   │  │  messages   │  │    ability_profiles     │  │
│  └─────────────┘  └─────────────┘  └─────────────────────────┘  │
└─────────────────────────────────────────────────────────────────┘
```

---

## 核心功能模块

### 1. 面试流程引擎 (LangGraph)

使用 LangGraph 状态机管理面试流程，支持：

- **开场白节点**: AI 面试官自我介绍，破冰
- **提问节点**: 根据简历和 JD 生成针对性问题
- **分析节点**: 实时分析用户回答质量
- **追问节点**: 根据回答进行深入追问
- **结束节点**: 生成面试总结报告

```python
# 状态定义 (InterviewState)
class InterviewState(TypedDict):
    messages: List[BaseMessage]     # 对话历史
    question_count: int             # 当前问题数
    max_questions: int              # 最大问题数
    current_question: str           # 当前问题
    mode: str                       # 面试模式 (coach/mock)
    is_finished: bool               # 是否结束
```

### 2. 会话管理系统

- 创建/恢复面试会话
- 持久化对话历史到 PostgreSQL
- 支持会话元数据 (模式、进度、状态)
- LangGraph Checkpointer 集成

### 3. 能力评估系统

- 单次面试能力档案 (Session Profile)
- 累计能力档案 (Overall Profile)
- 雷达图可视化
- 技能标签展示

---

## 技术栈

| 层级 | 技术选型 | 用途 |
|------|----------|------|
| **前端** | Next.js 15 + TypeScript | 现代化 React 框架 |
| **UI组件** | shadcn/ui + Radix UI | 精美组件库 |
| **状态管理** | Zustand | 轻量级状态管理 |
| **样式** | Tailwind CSS | 原子化 CSS |
| **后端** | FastAPI + Python 3.11 | 高性能异步框架 |
| **AI 编排** | LangGraph + LangChain | 智能体流程控制 |
| **LLM** | OpenAI GPT-4 / 兼容 API | 大语言模型 |
| **数据库** | PostgreSQL 16 | 关系型数据库 |
| **缓存** | asyncpg 连接池 | 数据库连接优化 |
| **部署** | Docker + Nginx | 容器化部署 |

---

## 项目目录结构

```
ai-interview/
├── backend/                    # 后端服务
│   ├── main.py                 # FastAPI 入口
│   ├── requirements.txt        # Python 依赖
│   ├── Dockerfile              # 后端容器配置
│   └── app/
│       ├── api/                # API 路由
│       │   ├── chat.py         # 聊天/面试接口 (流式响应)
│       │   ├── sessions.py     # 会话管理接口
│       │   ├── config.py       # 配置接口
│       │   └── upload.py       # 文件上传接口
│       ├── core/               # 核心逻辑
│       │   ├── graph.py        # LangGraph 面试状态机
│       │   ├── llms.py         # LLM 客户端管理
│       │   ├── memory.py       # 对话记忆
│       │   └── mode_strategy.py # 面试模式策略
│       ├── database/           # 数据库层
│       │   ├── base.py         # PostgreSQL 连接管理
│       │   ├── config.py       # 数据库配置
│       │   ├── init_db.py      # 数据库初始化脚本
│       │   └── session_service.py # 会话服务
│       ├── models/             # 数据模型
│       │   └── schemas.py      # Pydantic 模型
│       └── services/           # 业务服务
│           ├── ability_analyzer.py # 能力分析服务
│           └── profile_service.py  # 档案服务
│
├── web/                        # 前端应用
│   ├── app/                    # Next.js App Router
│   │   └── page.tsx            # 主页面
│   ├── components/             # React 组件
│   │   ├── ChatMessage.tsx     # 聊天消息组件
│   │   ├── SessionList.tsx     # 会话列表
│   │   ├── SessionSidebar.tsx  # 侧边栏
│   │   ├── SettingsDialog.tsx  # 设置对话框
│   │   ├── AbilityProfileView.tsx # 能力档案视图
│   │   ├── RadarChart.tsx      # 雷达图
│   │   └── ui/                 # shadcn/ui 组件
│   ├── store/                  # Zustand 状态
│   │   └── useInterviewStore.ts
│   ├── hooks/                  # 自定义 Hooks
│   ├── lib/                    # 工具库
│   ├── next.config.ts          # Next.js 配置
│   ├── package.json            # Node 依赖
│   └── Dockerfile              # 前端容器配置
│
├── nginx/                      # Nginx 反向代理
│   └── nginx.conf
│
├── docker-compose.yml          # Docker 编排
├── .env.production.example     # 生产环境变量模板
├── DEPLOYMENT.md               # 部署指南
│
└── docs/                       # 项目文档
    ├── 面试智能体项目开发路线.md  # 本文档
    ├── 快速启动指南.md
    └── 项目框架.md
```

---

## 开发进度

### ✅ 已完成功能

1. **基础架构**
   - [x] FastAPI 后端框架搭建
   - [x] Next.js 前端框架搭建
   - [x] PostgreSQL 数据库集成
   - [x] Docker 容器化配置

2. **核心面试功能**
   - [x] LangGraph 面试状态机
   - [x] 流式响应 (SSE)
   - [x] 简历上传与解析
   - [x] JD 职位描述输入
   - [x] 多模式支持 (Coach / Mock)

3. **会话管理**
   - [x] 会话创建/恢复
   - [x] 对话历史持久化
   - [x] 会话列表展示
   - [x] 会话删除

4. **能力评估**
   - [x] 单次面试能力分析
   - [x] 累计能力档案
   - [x] 雷达图可视化
   - [x] 技能标签展示

5. **用户体验**
   - [x] 精美 UI 设计
   - [x] 深色主题
   - [x] 响应式布局
   - [x] 面试进度显示
   - [x] 设置对话框 (API 配置)

### 🚧 待开发功能

1. **语音交互**
   - [ ] 语音输入 (STT - Whisper)
   - [ ] 语音输出 (TTS - ElevenLabs/OpenAI)
   - [ ] VAD 静音检测

2. **知识库增强**
   - [ ] 向量数据库集成 (RAG)
   - [ ] 面试题库导入
   - [ ] 个性化题目推荐

3. **高级分析**
   - [ ] 多维度评分
   - [ ] 历史趋势分析
   - [ ] PDF 报告导出

---

## 快速开始

### 本地开发

```bash
# 1. 启动后端
cd backend
pip install -r requirements.txt
python main.py

# 2. 启动前端
cd web
npm install
npm run dev
```

### Docker 部署

```bash
# 使用 Docker Compose 启动所有服务
docker-compose --env-file .env.production up -d --build
```

---

## API 接口概览

| 方法 | 路径 | 描述 |
|------|------|------|
| `POST` | `/api/chat/stream` | 发送消息，获取流式响应 |
| `POST` | `/api/chat/start` | 开始新面试 |
| `GET` | `/api/sessions/` | 获取会话列表 |
| `GET` | `/api/sessions/{id}` | 获取会话详情 |
| `POST` | `/api/sessions/` | 创建新会话 |
| `PATCH` | `/api/sessions/{id}` | 更新会话 |
| `DELETE` | `/api/sessions/{id}` | 删除会话 |
| `POST` | `/api/upload/resume` | 上传简历 |
| `GET` | `/api/config/` | 获取配置 |
| `POST` | `/api/config/` | 更新配置 |

---

## 环境变量

```bash
# 数据库
DATABASE_URL=postgresql://user:pass@localhost:5432/ai_interview

# LLM 配置
OPENAI_API_KEY=sk-xxx
OPENAI_BASE_URL=https://api.openai.com/v1
SMART_MODEL=gpt-4
FAST_MODEL=gpt-3.5-turbo

# 前端
NEXT_PUBLIC_API_URL=http://localhost:8000
```

---

## 参考资源

- [LangGraph 官方文档](https://langchain-ai.github.io/langgraph/)
- [FastAPI 文档](https://fastapi.tiangolo.com/)
- [Next.js 文档](https://nextjs.org/docs)
- [PostgreSQL 文档](https://www.postgresql.org/docs/)
- [shadcn/ui 组件库](https://ui.shadcn.com/)

---

*最后更新: 2025-12-05*
